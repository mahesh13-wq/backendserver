"""
Microsoft Rewards Search Helper - Educational Tool
WARNING: Automated searching violates Microsoft Terms of Service
This tool helps ORGANIZE manual searches only
"""

import webbrowser
import time
import random
from datetime import datetime
import json
import os

class MicrosoftRewardsHelper:
    def __init__(self):
        self.data_file = "rewards_progress.json"
        self.pc_max = 30  # Maximum PC searches per day (India Level 2)
        self.mobile_max = 20  # Maximum mobile searches per day
        self.pc_points = 3  # Points per PC search
        self.mobile_points = 3  # Points per mobile search
        
        # Diverse search topics for manual searching
        self.search_topics = [
            "weather forecast today", "latest technology news", "healthy recipes",
            "stock market updates", "sports scores", "movie reviews 2025",
            "best smartphones 2025", "fitness tips", "travel destinations",
            "python programming tutorial", "AI news", "book recommendations",
            "cricket news India", "cooking recipes", "investment tips",
            "space exploration", "electric vehicles news", "climate change",
            "music albums 2025", "gaming news", "health wellness tips",
            "business news India", "photography tips", "science discoveries",
            "fashion trends", "home decor ideas", "productivity apps",
            "language learning", "historical facts", "environmental conservation",
            "yoga exercises", "budget travel tips", "tech gadgets 2025"
        ]
        
        self.load_progress()
    
    def load_progress(self):
        """Load today's progress from file"""
        if os.path.exists(self.data_file):
            with open(self.data_file, 'r') as f:
                data = json.load(f)
                today = datetime.now().strftime("%Y-%m-%d")
                
                # Reset if it's a new day
                if data.get('date') != today:
                    self.reset_progress()
                else:
                    self.pc_searches = data.get('pc_searches', 0)
                    self.mobile_searches = data.get('mobile_searches', 0)
        else:
            self.reset_progress()
    
    def save_progress(self):
        """Save progress to file"""
        data = {
            'date': datetime.now().strftime("%Y-%m-%d"),
            'pc_searches': self.pc_searches,
            'mobile_searches': self.mobile_searches
        }
        with open(self.data_file, 'w') as f:
            json.dump(data, f, indent=2)
    
    def reset_progress(self):
        """Reset daily progress"""
        self.pc_searches = 0
        self.mobile_searches = 0
        self.save_progress()
    
    def display_banner(self):
        """Display warning banner"""
        print("\n" + "="*70)
        print("‚ö†Ô∏è  MICROSOFT REWARDS SEARCH HELPER - EDUCATIONAL TOOL")
        print("="*70)
        print("WARNING: Automated searching violates Microsoft Terms of Service!")
        print("Consequences: Account ban, point loss, IP blocking")
        print("This tool helps ORGANIZE manual searches only!")
        print("="*70 + "\n")
    
    def show_progress(self):
        """Display current progress"""
        pc_percent = (self.pc_searches / self.pc_max) * 100
        mobile_percent = (self.mobile_searches / self.mobile_max) * 100
        total_points = (self.pc_searches * self.pc_points) + (self.mobile_searches * self.mobile_points)
        
        print("\nüìä TODAY'S PROGRESS")
        print("-" * 50)
        print(f"PC Searches: {self.pc_searches}/{self.pc_max} ({pc_percent:.1f}%) - {self.pc_searches * self.pc_points} points")
        print(f"{'‚ñà' * int(pc_percent/5)}{'-' * (20-int(pc_percent/5))}")
        print(f"\nMobile Searches: {self.mobile_searches}/{self.mobile_max} ({mobile_percent:.1f}%) - {self.mobile_searches * self.mobile_points} points")
        print(f"{'‚ñà' * int(mobile_percent/5)}{'-' * (20-int(mobile_percent/5))}")
        print(f"\nüí∞ Total Points Today: {total_points}")
        print("-" * 50 + "\n")
    
    def get_random_topics(self, count=5):
        """Get random search topics"""
        return random.sample(self.search_topics, min(count, len(self.search_topics)))
    
    def open_search(self, query, device_type='pc'):
        """Open Bing search in browser (requires manual interaction)"""
        url = f"https://www.bing.com/search?q={query.replace(' ', '+')}"
        print(f"\nüîç Opening search: '{query}'")
        print(f"   Device: {device_type.upper()}")
        print(f"   URL: {url}")
        
        # Open browser for MANUAL interaction
        webbrowser.open(url)
        
        print("\n‚ö†Ô∏è  IMPORTANT REMINDERS:")
        print("   ‚Ä¢ You MUST interact with the search results manually")
        print("   ‚Ä¢ Click on links, scroll, read content naturally")
        print("   ‚Ä¢ Wait 10-30 seconds between searches")
        print("   ‚Ä¢ Don't open multiple tabs rapidly\n")
        
        # Wait for user confirmation
        input("Press ENTER after you've manually completed this search...")
        
        # Log the search
        if device_type == 'pc' and self.pc_searches < self.pc_max:
            self.pc_searches += 1
        elif device_type == 'mobile' and self.mobile_searches < self.mobile_max:
            self.mobile_searches += 1
        
        self.save_progress()
    
    def manual_search_session(self, device_type='pc'):
        """Guided manual search session"""
        max_searches = self.pc_max if device_type == 'pc' else self.mobile_max
        current = self.pc_searches if device_type == 'pc' else self.mobile_searches
        remaining = max_searches - current
        
        if remaining <= 0:
            print(f"\n‚úÖ You've completed all {device_type.upper()} searches for today!")
            return
        
        print(f"\nüéØ MANUAL SEARCH SESSION - {device_type.upper()}")
        print(f"Remaining searches: {remaining}")
        
        num_searches = int(input(f"\nHow many searches do you want to do now? (1-{remaining}): "))
        num_searches = min(num_searches, remaining)
        
        topics = self.get_random_topics(num_searches)
        
        print(f"\nüìù Suggested topics for your {num_searches} searches:")
        for i, topic in enumerate(topics, 1):
            print(f"   {i}. {topic}")
        
        print("\n‚è∞ Remember: Wait 10-30 seconds between each search!")
        input("\nPress ENTER to start...\n")
        
        for i, topic in enumerate(topics, 1):
            print(f"\n--- Search {i}/{num_searches} ---")
            self.open_search(topic, device_type)
            
            if i < num_searches:
                wait_time = random.randint(10, 30)
                print(f"\n‚è≥ Waiting {wait_time} seconds before next search...")
                time.sleep(wait_time)
        
        print(f"\n‚úÖ Session complete! Completed {num_searches} searches.")
        self.show_progress()
    
    def show_menu(self):
        """Display main menu"""
        while True:
            self.show_progress()
            print("üìã MENU")
            print("1. Start PC Search Session (Manual)")
            print("2. Start Mobile Search Session (Manual)")
            print("3. View Random Search Topics")
            print("4. Show Safe Earning Tips")
            print("5. Reset Today's Progress")
            print("6. Exit")
            
            choice = input("\nSelect option (1-6): ").strip()
            
            if choice == '1':
                self.manual_search_session('pc')
            elif choice == '2':
                self.manual_search_session('mobile')
            elif choice == '3':
                self.show_topics()
            elif choice == '4':
                self.show_safe_tips()
            elif choice == '5':
                confirm = input("Reset today's progress? (yes/no): ").lower()
                if confirm == 'yes':
                    self.reset_progress()
                    print("‚úÖ Progress reset!")
            elif choice == '6':
                print("\nüëã Goodbye! Remember: Manual searching only!")
                break
            else:
                print("‚ùå Invalid option. Try again.")
    
    def show_topics(self):
        """Display random search topics"""
        print("\nüí° RANDOM SEARCH TOPIC IDEAS")
        print("-" * 50)
        topics = self.get_random_topics(15)
        for i, topic in enumerate(topics, 1):
            print(f"{i:2d}. {topic}")
        print("-" * 50)
        input("\nPress ENTER to continue...")
    
    def show_safe_tips(self):
        """Display safe earning tips"""
        print("\n‚úÖ SAFE WAYS TO MAXIMIZE MICROSOFT REWARDS")
        print("-" * 50)
        print("1. ‚úì Search genuinely interesting topics throughout the day")
        print("2. ‚úì Complete daily quizzes on Bing homepage")
        print("3. ‚úì Use Microsoft Edge browser for bonus points (+12/day)")
        print("4. ‚úì Enable Bing app on mobile for mobile searches")
        print("5. ‚úì Participate in daily streaks for bonus rewards")
        print("6. ‚úì Read news articles for 'Read & Earn' points")
        print("7. ‚úì Spread searches naturally - morning, lunch, evening")
        print("8. ‚úì Actually click and read search results")
        print("\n‚ùå NEVER DO:")
        print("   √ó Use automation scripts or bots")
        print("   √ó Open searches too rapidly (< 10 seconds apart)")
        print("   √ó Use VPN or multiple accounts")
        print("   √ó Click through without reading content")
        print("-" * 50)
        input("\nPress ENTER to continue...")

def main():
    """Main function"""
    helper = MicrosoftRewardsHelper()
    helper.display_banner()
    
    print("Welcome to Microsoft Rewards Search Helper!")
    print("This tool helps you organize your MANUAL searches.\n")
    
    try:
        helper.show_menu()
    except KeyboardInterrupt:
        print("\n\nüëã Exiting... Remember to search manually!")
    except Exception as e:
        print(f"\n‚ùå Error: {e}")

if __name__ == "__main__":
    main()
